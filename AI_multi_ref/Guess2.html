{{ block title }}
        <p><center><strong>Round {{ player.round_number}}</strong></center></p>
{{ endblock }}
{{ block content }}

<!-- present previous guess and ref -->
あなたの<font color="blue" style="opacity: 0.5;"><b>1回目の推測結果</b></font>は：
<font color="blue" style="opacity: 0.5;"><b id="id_guess_1">{{ player.guess_1 }}</b></font>
<p> </p>
<font color="red" style="opacity: 0.5;"><b>ChatGPTの推測結果</b></font>は：
<font color="red" style="opacity: 0.5;"><b id="id_ref">{{ player.AI_reference }}</b></font>
<p> </p>
<p> </p>
<!-- present previous guess and ref -->


<p><b>このニュースの正しさを再度推測してください。</b></p>
<p> </p>
<p> </p>

<p> </p>
<p> </p>
<HR style="FILTER: alpha(opacity=100,finishopacity=0,style=3)" width="100%" color=#987cb9 SIZE=6>
<p> </p>

<center><strong>2回目の推測:</strong></center>

<!-- slider input -->
<link rel="stylesheet" href="{% static 'global/smdr_slider_g2.css' %}">

<style>
    #scale_num{
        width: 100%;
    }
</style>
<!-- slider input -->

<!-- field -->
<div class="card bg-light mx-auto p-5 my-2">
    <div> 
            現在の推測: <b id="current_input">?</b>
    </div>
        <label for="slider" class="form-label"></label>

    <div class="slider-container" style="position: relative;">
        <div class="dot dot-guess-1" id="dot-guess-1"></div>
        <div class="dot dot-ref" id="dot-ref"></div>
        <input type="range" name='guess_2' class="form-range nonanchoring" min="0" list="scale" id="slider">
    </div>

        <div class="grid" id="scale_grid"></div>
        <div class="d-flex justify-content-between" id="scale_num"></div>
</div>
<!-- field -->

<!-- slider_setting -->
<script>
    // 最大値と刻み幅の設定
    const slider = document.getElementById('slider');
    slider.max = 100;
    slider.step = 1;
    slider.value = 0;

    // only add grip at start and end
    var gridspan_start = document.createElement('span');
    gridspan_start.classList.add("boldgrid");
    scale_grid.append(gridspan_start);

    var gridspan_end = document.createElement('span');
    gridspan_end.classList.add("boldgrid");
    scale_grid.append(gridspan_end);

    // WTPの表示
    function render (output, value) {
        output.innerHTML = value;
    }
    const input = document.querySelector('input');
    const output = document.getElementById('current_input');

    input.addEventListener('input', function (e) {
        render(output, e.target.value)
    }, false)

    $(document).ready(function () {
        $('input.nonanchoring').on('click', function () {
            $('input.nonanchoring').addClass('nonanchoring_thumb');
            render(output, input.value);
        });
    });



    // present 1st guess and Reference
   document.addEventListener("DOMContentLoaded", function() {
        var slider = document.querySelector(".form-range");
        var dotGuess1 = document.getElementById("dot-guess-1");
        var dotRef = document.getElementById("dot-ref");
        
        var guess_1_element = document.getElementById("id_guess_1");
        var guess_1 = parseInt(guess_1_element.innerText, 10);
        
        var ref_element = document.getElementById("id_ref");
        var ref = parseInt(ref_element.innerText, 10);

        const sliderContainer = document.querySelector(".slider-container");
        const boldGridElements = document.querySelectorAll(".grid span.boldgrid");    
        const leftLineCenter = boldGridElements[0].getBoundingClientRect().left + boldGridElements[0].getBoundingClientRect().width / 2 - sliderContainer.getBoundingClientRect().left;
        const rightLineCenter = boldGridElements[1].getBoundingClientRect().left + boldGridElements[1].getBoundingClientRect().width / 2 - sliderContainer.getBoundingClientRect().left;
        const gridslider = rightLineCenter - leftLineCenter

        function updateDotsPosition() {
            // var guess1Position = (guess_1 / slider.max) * slider.offsetWidth+ offset;
            // var refPosition = (ref / slider.max) * slider.offsetWidth+ offset;

            var guess1Position = (guess_1 / slider.max) * gridslider;
            var refPosition = (ref / slider.max) * gridslider;

            dotGuess1.style.left = guess1Position + "px";
            dotRef.style.left = refPosition + "px";
        }

        // Update dots position initially and also when window resizes
        updateDotsPosition();
        window.addEventListener("resize", updateDotsPosition);
    });


    document.getElementById("slider").addEventListener("input", function() {
        document.getElementById("nextButton").disabled = false;
    });
</script>
<!-- slider_setting -->

<!-- boundline -->
<p> </p>
<HR style="FILTER: alpha(opacity=100,finishopacity=0,style=3)" width="100%" color=#987cb9 SIZE=6>
<p> </p>





<p><b>答えを出しましたら、<font color="blue">「次へ」</font>を押してください。</b></p>
  
<p style="text-align: right;">
  <button class="otree-btn-next btn btn-primary"id="nextButton" disabled >次へ</button>
</p>
    
{{ endblock }}
